@inject IJSRuntime JS
@rendermode InteractiveServer

<div>
  <input @bind="email" placeholder="Email" />
  <input @bind="password" type="password" placeholder="Password" />
  <button @onclick="LoginAsync">Login</button>

  @if (!string.IsNullOrEmpty(status))
  {
      <p>@status</p>
  }
</div>

@code {
  private string email = "";
  private string password = "";
  private string status = "";

  [Parameter]
  public EventCallback OnLoginSuccess { get; set; }

  private async Task LoginAsync()
  {
      status = "Login in corso...";
      StateHasChanged();

      var result = await JS.InvokeAsync<string>("firebaseLogin", email, password);

      if (result.StartsWith("ERROR"))
      {
          status = $"Errore login: {result.Replace("ERROR:", "")}";
      }
      else
      {
          status = "Login riuscito!";
          await OnLoginSuccess.InvokeAsync();
      }
  }
}
